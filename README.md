# Suprema Fingerprint Enrollment and Matcher #

## Описание проекта ##
Демонстрационный проект на Django REST Framework, предназначенный для интеграции 
сканеров отпечатков пальцев `Suprema RealScan-G10` и `Suprema BioMini` в 
основной облачным WEB-сервис.

> Служит вспомогательным сервисом для работы с биометрическими персональными данными 
в пределах контролируемой зоны (КЗ).

### Задачи ###
Проект помогает выполнить задачи по сбору отпечатков данных с сотрудников с 
помощью устройства `Suprema RealScan-G10` и задачи по 
идентификации и верификации, используя устройство `Suprema BioMini`.

### Функциональные возможности ###
В проекте реализованы следующие  функциональные возможности:
* создание субъекта идентификационных данных (_далее - **СИД**_);
* парсинг данных, полученных со сканера и их добавление в базу данных (**Enrollment**);
* синхронизация Enrollment данных с основным облачным WEB-сервисом;
* удаление данных о СИД;
* верификация и идентификация СИД по шаблону отпечатка пальца (**Matcher**).

## Особенности проекта ##
### Реализация проекта ###

> Проект подходит для реализации только в демонстрационных целях.

Проект был реализован на территории страны **"Танзания"**, где не действуют требования 
ФСБ, ФСТЭК и других регулирующих органов в области информационной безопасности, 
поэтому данный проект не реализует взаимодействие с облачным сервисом через 
выделенный защищенный канал (VPN), и процесс хранения и обработки информации может 
не соответствовать необходимым требованиям ИБ. 

### Лицензионные ограничения ###

> Для использования библиотек необходим сканер `Suprema`, 
подключенный к серверу по USB, на котором развернут проект. По этой причине 
реализация проекта на облачном хостинге весьма проблематична.

Для матчинга (верификации и идентификации) используются поставляемые вместе с SDK библиотеки 
`UFMatcher.dll` (_Windows_) или `libNFiQ2.so` и `libUFMatcher.so` (_Linux_) в зависимости от 
операционной системы, на которой размещается данный проект.

Эти библиотеки требуют наличия лицензии и имеют следующий принцип проверки: 
при вызове методов из библиотеки 
происходит проверка подключенных USB устройств, среди которых должен быть найден 
сканер отпечатков пальцев Suprema, с него считывается уникальный UUID, который и 
является лицензионным ключом для библиотеки.

### Совместимость ###

> Для использования других устройств, возможно, придется изменить сериализатор 
для Enrollment.

Проект создавался под уже существующие решения и конкретные устройства,
которые предоставляют информацию в определенном формате через их собственные API:
* **Suprema RealScan-G10** для Enrollment; 
* **Suprema BioMini** для идентификации и верификации.

### Шаблонная схема взаимодействия

Схема взаимодействия содержит следующие элементы:
* Облачный web-сервис (`web.server.domain:443`);
* API Enrollment & Matcher (`192.168.0.10:443` / `biometry.local:443`);
* ПК пользователя с подключенными устройствами Suprema (`192.168.0.155`);
* API Suprema RealScan-G10 (`192.168.0.155:11121` / `127.0.0.1:11121`);
* API Suprema BioMini (`192.168.0.155:5678` / `127.0.0.1:5678`);

**API Suprema** становятся доступны после установки драйверов и запуска соответсвующей службы. 
Все запросы инициируются клиентом с ПК пользователя, поэтому API Suprema для клиента 
доступны через `localhost` (`127.0.0.1`).

## Описание функциональных возможностей

### Enrollment

![Enrollment scheme](https://github.com/mr-Marshanskiy/suprema_fingerprint_matcher/tree/main/media/Enrollment.jpg)

Для процедуры записи (Enrollment) используется сканер **Suprema RealScan-G10**. 

1. Клиент отправляет запрос на web-сервис для получения информации о целевом сотруднике
```
   GET https://web.server.domain/api/employees/100/
```

2. Web-сервис возвращает ответ с данными
```
   200 OK
   {
      "id": 100,
      "first_name": "Ivan",
      "last_name": "Ivanov",
      ...
   }
```

3. Клиент отправляет запрос на API RealScan-G10
```
   GET http://127.0.0.1:11121/rswas/DeviceInfo - Проверка доступности устройства
   POST http://127.0.0.1:11121/rswas/Capture - Начало процедуры сканирования
   GET http://127.0.0.1:11121/rswas/CanvasInfo - Получение отпечатков
```

4. API RealScan-G10 возвращает ответ, в котором содержится информация о
всех отсканированных пальцах по отдельности и об отпечатках ладоней
```
   200 OK
   {
      {
        "captureMode": "string",
        "captureType": "string",
        "errCode": 0,
        "errMsg": "string",
        "fingers": [
          {
            "fingerNo": "string",
            "imgQuality": 0,
            "wsqData": "string",
            "imgType": "string",
            "imgData": "string",
            "isoFMRType": "string",
            "isoFMRData": "string",
            "isoFIRType": "string",
            "isoFIRData": "string"
          }
        ],
        "slaps": [
          {
            "slapType": "string",
            "wsqData": "string",
            "imgType": "string",
            "imgData": "string",
            "isoFIRType": "string",
            "isoFIRData": "string"
          }
        ]
      }
   }
```

5. Клиент добавляет к полученным данным информацию из web-сервиса в ключ `person`
и отправляет запрос на **API Enrollment & Matcher**
```
   Добавить к ответу:
  
"person": {
    "first_name": "Ivan",
    "last_name": "Ivanov",
    "board_id": 100,
    "status": "employee"
}
 
POST https:biometry.local/api/fingerprints/enrollment/
   body = [полученный JSON]
```

6. **API Enrollment & Matcher** выполняет следующие шаги:
* получает запрос от клиента;
* создает объект модели `persons.Person` из значений по ключу `person` в body;
* создает `fingerprints.Enrollment`;
* создает объекты `fingerprints.Slap` из массива по ключу `slaps` в body;
* создает объекты `fingerprints.Fingerprint` из массива по ключу ключа `fingers` в body;
* запускает процесс синхронизации с web-сервисом: генериррует и отправляет информацию 
о UUID созданных отпечатков. В заголовке передается Токен для авторизации.
```
   POST https://web.server.domain/api/api/biometry/fingerprints/enrollment/employee/
   body = {
     "person": "string",
     "fingers": [
       "eb23dcda-71dc-11ee-b962-0242ac120002",
       "6845f385-0cfd-492e-9d1e-e8010de862b4",
       ....
      ]
   }
```
* после получения ответа от web-сервиса отправляет ответ клиенту (п.8);

7. **Web-сервис** связывает полученные UUID с объектом целевого сотрудника
8. **API Enrollment & Matcher** отправляет ответ клиенту
```
   201 CREATED
```
9. Клиент запрашивает у web-сервиса обновленную информацию о сотруднике
10. Web-сервис возвращает информацию с массивом пальцев, на которые есть отпечатки 
в базе данных API Enrollment & Matcher. Информация отрисовывается на клиенте.

### Identification

![Enrollment scheme](https://github.com/mr-Marshanskiy/suprema_fingerprint_matcher/tree/main/media/Identify.jpg)

### Verification

![Enrollment scheme](https://github.com/mr-Marshanskiy/suprema_fingerprint_matcher/tree/main/media/Verify.jpg)

### Удаление записей
Проект также включает в себя метод удаления записей об отпечатках пальцев.

### Синхронизация данных
Процессы записи и удаления отпечатков сопровождаются синхронизацией данных 
с API-сервисом, обозначенным условно как "Board".


> Важно отметить, что данное решение оптимизировано для использования с 
конкретными сканерами **Suprema RealScan-G10** для Enrollment и **Suprema BioMini** для идентификации и верификации, 
поскольку проект спроектирован для работы с данными сканерами, 
которые предоставляют информацию в определенном формате через их собственные API.


1. **API с использованием DRF**: Проект использует Django REST framework для создания RESTful API, обеспечивающего [описание возможностей, предоставляемых API].

2. **[Другие ключевые особенности]**: [Описание других важных особенностей проекта, таких как аутентификация, авторизация, фронтенд и другие].

## Используемые технологии

- **Django**: Основной фреймворк для веб-разработки.
- **Django REST framework (DRF)**: Используется для разработки API.
- **[Другие библиотеки и инструменты]**: [Список других технологий и инструментов, используемых в проекте].

## Установка и запуск

1. **Клонирование репозитория**:

   ```bash
   git clone [URL-репозитория]
   ```

2. **Создание виртуальной среды** (рекомендуется использовать [инструмент виртуальной среды]):

   ```bash
   virtualenv venv
   ```

3. **Активация виртуальной среды**:

   ```bash
   source venv/bin/activate
   ```

4. **Установка зависимостей**:

   ```bash
   pip install -r requirements.txt
   ```

5. **Настройка базы данных**:

   ```bash
   python manage.py migrate
   ```

6. **Запуск проекта**:

   ```bash
   python manage.py runserver
   ```

## Документация API

Документация по API доступна по адресу [ссылка на документацию].

## Вклад и разработка

Если вы хотите внести вклад в проект, пожалуйста, ознакомьтесь с [руководством по внесению вклада] и отправьте запрос на объединение (Pull Request).

## Лицензия

Проект лицензирован под [указание типа лицензии, например, MIT лицензия]. Подробности см. в файле LICENSE.

## Авторы

- [Ваше имя]
- [Другие участники проекта]

## Связь

Если у вас есть вопросы или предложения, свяжитесь с нами по адресу [ваш email] или [ссылка на страницу проекта].

Это лишь образец описания проекта в формате Markdown для проекта, использующего Django REST framework. Вы можете настроить этот шаблон, добавив дополнительные сведения и документацию, соответствующие вашему конкретному проекту.